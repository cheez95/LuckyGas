<!DOCTYPE html>
<html>
<head>
    <title>Test Modal Fixes</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="p-8">
    <h1 class="text-2xl font-bold mb-4">Testing Modal Fixes</h1>
    
    <div class="space-y-4">
        <button onclick="testModal()" class="bg-blue-500 text-white px-4 py-2 rounded">
            Test Modal Close
        </button>
        
        <button onclick="testDashboardLoad()" class="bg-green-500 text-white px-4 py-2 rounded">
            Test Dashboard Load
        </button>
        
        <div id="status" class="mt-4 p-4 bg-gray-100 rounded"></div>
    </div>
    
    <!-- Test Modal -->
    <div id="testModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 max-w-md w-full">
            <h3 class="text-xl font-bold mb-4">Test Modal</h3>
            <p>This is a test modal to verify the close functionality works.</p>
            <div class="flex justify-end gap-4 mt-4">
                <button onclick="closeModal('testModal')" class="px-4 py-2 text-gray-600 bg-gray-100 rounded">
                    Close Modal
                </button>
            </div>
        </div>
    </div>
    
    <script>
        // Test the fixed closeModal function
        function closeModal(modalOrId) {
            let modal;
            
            if (typeof modalOrId === 'string') {
                modal = document.getElementById(modalOrId);
            } else if (modalOrId instanceof HTMLElement) {
                modal = modalOrId;
            } else {
                console.error('Invalid modal parameter:', modalOrId);
                return;
            }
            
            if (modal) {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
                updateStatus('Modal closed successfully!');
            }
        }
        
        function testModal() {
            const modal = document.getElementById('testModal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            updateStatus('Modal opened');
        }
        
        async function testDashboardLoad() {
            updateStatus('Testing dashboard API...');
            try {
                const response = await fetch('http://localhost:8000/api/dashboard/stats');
                const data = await response.json();
                updateStatus(`Dashboard API works! Total clients: ${data.overview.total_clients}`);
            } catch (error) {
                updateStatus(`Error: ${error.message}`, true);
            }
        }
        
        function updateStatus(message, isError = false) {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `mt-4 p-4 rounded ${isError ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700'}`;
        }
    </script>
</body>
</html>